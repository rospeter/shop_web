<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>电商首页</title>
    <style>
        /* 页面重置 */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background-color: #f5f5f5; }

        /* 顶部导航栏 */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #fff;
            padding: 10px 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .navbar .logo { font-size: 24px; font-weight: bold; color: #333; }
        .navbar .search-bar input {
            width: 300px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .navbar .user-info a, .navbar .cart a {
            margin-left: 20px;
            color: #333;
            text-decoration: none;
            font-size: 16px;
        }

        /* 主横幅区域 */
        .banner {
            width: 100%;
            height: 300px;
            background: url('https://via.placeholder.com/1200x300') no-repeat center center;
            background-size: cover;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 36px;
            font-weight: bold;
        }

        /* 商品分类导航 */
        .categories {
            display: flex;
            justify-content: space-around;
            background-color: #fff;
            padding: 20px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .categories .category {
            text-align: center;
            font-size: 18px;
            color: #333;
        }
        .categories .category img {
            width: 50px;
            height: 50px;
            margin-bottom: 10px;
        }

        /* 推荐商品区域 */
        .products {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            padding: 20px;
        }
        .products .product {
            width: 30%;
            background-color: #fff;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            text-align: center;
        }
        .products .product img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        .products .product .info {
            padding: 10px;
        }
        .products .product .info .name {
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }
        .products .product .info .price {
            font-size: 16px;
            color: #e74c3c;
        }

        /* 底部信息区 */
        .footer {
            background-color: #333;
            color: #fff;
            padding: 20px;
            text-align: center;
        }
        .footer a {
            color: #fff;
            text-decoration: none;
            margin: 0 10px;
        }
    </style>
</head>
<body>

<!-- 顶部导航栏 -->
<div class="navbar">
    <div class="logo">电商平台</div>
    <div class="search-bar">
        <input type="text" placeholder="搜索商品...">
    </div>

    <!-- 只改 user-info 部分，替换成下面这段 -->

    <div class="user-info">
        <!-- 没登录，显示登录注册 -->
        <span th:if="${session.user == null}">
        <a href="/login">登录</a>
        <a href="/register">注册</a>
    </span>

        <!-- 登录了，显示欢迎和退出 -->
        <span th:if="${session.user != null}">
        欢迎，<span th:text="${session.user.username}">用户名</span>
        <a href="/logout" style="margin-left: 15px;">退出登录</a>

            <!-- 只有管理员显示后台管理 -->
        <a th:if="${session.user.role == 'ADMIN'}"
           href="/admin/products"
           style="color: #ffcc00; margin-left: 20px; font-weight: bold;">
           后台管理
        </a>
    </span>
    </div>


    <div class="cart">
        <a href="/cart">购物车</a>
    </div>
</div>

<!-- 主横幅区域 -->
<div class="banner">
    欢迎来到我们的电商平台！
</div>

<!-- 商品分类导航 -->
<!-- 商品分类导航 -->
<div class="categories">
    <div class="category">
        <img src="https://via.placeholder.com/50" alt="分类1">
        <div>分类1</div>
    </div>
    <div class="category">
        <img src="https://via.placeholder.com/50" alt="分类2">
        <div>分类2</div>
    </div>
    <div class="category">
        <img src="https://via.placeholder.com/50" alt="分类3">
        <div>分类3</div>
    </div>
</div>

<!-- 推荐商品区域 -->
<div class="products" id="product-list">
    <!-- 商品将通过 JS 加载 -->
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        fetch("/api/products")
            .then(res => res.json())
            .then(products => {
                const container = document.getElementById("product-list");
                container.innerHTML = "";
                products.forEach(p => {
                    const productDiv = document.createElement("div");
                    productDiv.className = "product";

                    productDiv.innerHTML = `
                    <a href="/product/${p.id}" style="text-decoration: none; color: inherit;">
                        <img src="${p.imageUrl || 'https://via.placeholder.com/300x200?text=无图'}" alt="${p.name}">
                        <div class="info">
                            <div class="name"></div>
                            <div class="price"></div>
                        </div>
                    </a>
                `;

                    productDiv.querySelector(".name").textContent = p.name;
                    productDiv.querySelector(".price").textContent = `￥${p.price.toFixed(2)}`;

                    container.appendChild(productDiv);
                });
            })
            .catch(err => {
                console.error("加载商品失败:", err);
                document.getElementById("product-list").textContent = "加载商品失败，请稍后重试。";
            });
    });
</script>

<!-- 底部信息区 -->
<div class="footer">
    <a href="#">关于我们</a>
    <a href="#">联系我们</a>
    <a href="#">隐私政策</a>
    <a href="#">社交媒体</a>
</div>

</body>
</html>
